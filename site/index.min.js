(function e$$0(g,h,m){function l(d,a){if(!h[d]){if(!g[d]){var c="function"==typeof require&&require;if(!a&&c)return c(d,!0);if(n)return n(d,!0);c=Error("Cannot find module '"+d+"'");throw c.code="MODULE_NOT_FOUND",c;}c=h[d]={exports:{}};g[d][0].call(c.exports,function(a){var c=g[d][1][a];return l(c?c:a)},c,c.exports,e$$0,g,h,m)}return h[d].exports}for(var n="function"==typeof require&&require,k=0;k<m.length;k++)l(m[k]);return l})({1:[function(p,g,h){(function(g){for(var l in React.DOM)g[l]=React.DOM[l];
var h=React.createClass({getInitialState:function(){return{id:0,ws:null,page:"home",question:"",questions:[],answereds:[],dunnos:[],points:0}},componentDidMount:function(){var k=new WebSocket(SERVER_URL);k.onopen=function(){console.log("connected")};k.onmessage=function(d){d=JSON.parse("["+d.data+"]");if(0===this.state.id){++this.state.id;for(var a=0,c=d.length;a<c;++a)"join"===d[a].type&&++this.state.id}a=0;for(c=d.length;a<c;++a){var b=d[a],e=this.state.questions[b.question_id];switch(b.type){case "ask":this.state.questions.push({id:this.state.questions.length,
user_id:b.user_id,text:b.question,time:b.time,answer:"",answer_time:0,persons:0,status:"routing"});break;case "answer":e.answer=b.answer;e.answer_time=b.time;b.user_id===this.state.id&&(this.state.answereds[b.question_id]=!0);break;case "dunno":++e.persons;b.user_id===this.state.id&&(this.state.dunnos[b.question_id]=!0);break;case "accept":""!==e.answer&&"routing"===e.status&&b.user_id===e.user_id&&(e.status="accepted",this.state.answereds[e.id]&&++this.state.points);break;case "refuse":""!==e.answer&&
"routing"===e.status&&b.user_id===e.user_id&&(e.status="refused",this.state.answereds[e.id]&&--this.state.points)}}console.log("Client id is: "+this.state.id);console.log("Questions: "+JSON.stringify(this.state.questions));this.state.act=function(a){return function(){k.send(JSON.stringify(a))}};this.forceUpdate()}.bind(this);setInterval(function(){this.forceUpdate()}.bind(this),500)},render:function(){function k(a){return div({className:"centralizer_outer"},div({className:"centralizer_inner"},a))}
var d=function(a){var d=div({className:"question_title"},[a.text]),c=div({className:"question_seconds"},Math.floor(((a.answer_time||Date.now())-a.time)/1E3)+'"'),b=div({className:"question_persons"},a.persons+"\uc6c3"),c=div({className:"question_head_box"},[c,b]),b=div({onClick:function(){this.state.act({type:"accept",user_id:this.state.id,question_id:a.id})()}.bind(this),className:"question_acception "+("accepted"===a.status?"accepted":"")},"\u2713"),e=div({onClick:function(){this.state.act({type:"refuse",
user_id:this.state.id,question_id:a.id})()}.bind(this),className:"question_acception "+("refused"===a.status?"refused":"")},"\u2717"),b=div({className:"question_acception_box"},[b,e]),c=div({className:"question_head"},[c,b]),b=div({className:"question_answer"},[""!==a.answer?a.answer:"Esperando resposta..."]),d=div({className:"question_body"},[d,b]),b=div({className:"question_lamp"},img({src:"routing"===a.status?""===a.answer?"img/lampada_apagada.png":"img/lampada_acesa.gif":"accepted"===a.status?
"img/lampada_acesa.png":"img/lampada_apagada.png",alt:"lampada",width:"100",height:"100"}));return div({className:"question"},[c,d,b])}.bind(this),a=this.state,c=div({onClick:function(){a.page="home"}.bind(this),className:"home"===a.page?"logo":"logo_small"},"dunno"),b=div({className:"question_field_box"},input({id:"question_field",key:"question_field",className:"question_field",placeholder:"<inserir slogan aqui>",onKeyPress:function(a){13===a.which&&e()},onChange:function(b){a.question=b.target.value;
this.forceUpdate()}.bind(this),type:"text"})),e=function(){0!==a.question.length&&(this.state.act({type:"ask",question:a.question,time:Date.now(),user_id:a.id})(),a.question="",a.page="wall",this.forceUpdate(),document.getElementById("question_field").value="")}.bind(this),f=div({id:"ask_button",key:"ask_button",onClick:e,className:"button ask_button"},["Fazer pergunta"]),g=div({id:"quick_button",key:"quick_button",onClick:function(){a.page="answering";this.forceUpdate()}.bind(this),className:"button quick_button"},
["Prefiro responder"]),g=div({key:"buttons_container",className:"button_container"},[f,g]),g=div({className:"home"},[c,b,g]),b=div({className:"wall_top"},k(div({className:"wall_top_content"},[c,b,f]))),f=a.questions.filter(function(b){return b.user_id===a.id}.bind(this)).reverse(),f=k(f.map(d)),b=div({className:"wall"},[b,f]),f=div({className:"answering_points"},"("+this.state.points+" ponto"+(1===this.state.points?"":"s")+"!)"),c=div({className:"answering_top"},[c,f]),h=function(){for(var b=null,
d=0,c=1103515245*a.id+12345&2147483647,e=0,f=a.questions.length;e<f;++e)c=1103515245*c+12345&2147483647,c>d&&a.questions[e]&&""===a.questions[e].answer&&!a.dunnos[e]&&(b=a.questions[e],d=c);return b}(),d=h?d(h):[],l=function(){var b=document.getElementById("answering_input");this.state.act({type:"answer",time:Date.now(),user_id:a.id,question_id:h.id,answer:b.value})();b.value=""}.bind(this),m=function(){this.state.act({type:"dunno",user_id:a.id,question_id:h.id})()}.bind(this),f=div({className:"answering_button",
onClick:l},"Responder"),m=div({className:"answering_button",onClick:m},"Dunno"),f=div({className:"answer_menu"},[div({},input({id:"answering_input",className:"answering_input ",onKeyDown:function(a){13===a.which&&l()}})),div({},[f,m])]),d=div({className:"answering_body"},[d,f]),f=div({className:"answering_done"},["Nada para responder! Esperando novas quest\u00f5es."]),d=h?div({},[c,k(d)]):div({},[c,k(f)]);return"home"===a.page?g:"wall"===a.page?b:d}});window.onload=function(){ReactDOM.render(React.createElement(h,
null),document.getElementById("test"))}}).call(this,"undefined"!==typeof global?global:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{})},{}]},{},[1]);
