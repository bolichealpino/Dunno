(function e$$0(f,g,m){function l(b,a){if(!g[b]){if(!f[b]){var d="function"==typeof require&&require;if(!a&&d)return d(b,!0);if(n)return n(b,!0);d=Error("Cannot find module '"+b+"'");throw d.code="MODULE_NOT_FOUND",d;}d=g[b]={exports:{}};f[b][0].call(d.exports,function(a){var d=f[b][1][a];return l(d?d:a)},d,d.exports,e$$0,f,g,m)}return g[b].exports}for(var n="function"==typeof require&&require,h=0;h<m.length;h++)l(m[h]);return l})({1:[function(p,f,g){(function(f){for(var l in React.DOM)f[l]=React.DOM[l];
var g=React.createClass({getInitialState:function(){return{id:0,ws:null,page:"home",question:"",questions:[],answereds:[],dunnos:[],points:0}},componentDidMount:function(){var h=new WebSocket(SERVER_URL);h.onopen=function(){console.log("connected")};h.onmessage=function(b){b=JSON.parse("["+b.data+"]");var a=!1;if(0===this.state.id){a=!0;++this.state.id;for(var d=0,k=b.length;d<k;++d)"join"===b[d].type&&++this.state.id}d=0;for(k=b.length;d<k;++d){var e=b[d],c=this.state.questions[e.question_id];switch(e.type){case "ask":this.state.questions.push({id:this.state.questions.length,
user_id:e.user_id,text:e.question,time:a?e.time:Date.now(),answer:"",answer_time:0,persons:0,status:"routing"});break;case "answer":c.answer=e.answer;c.answer_time=a?e.time:Date.now();e.user_id===this.state.id&&(this.state.answereds[e.question_id]=!0);break;case "dunno":++c.persons;e.user_id===this.state.id&&(this.state.dunnos[e.question_id]=!0);break;case "accept":""!==c.answer&&"routing"===c.status&&e.user_id===c.user_id&&(c.status="accepted",this.state.answereds[c.id]&&++this.state.points);break;
case "refuse":""!==c.answer&&"routing"===c.status&&e.user_id===c.user_id&&(c.status="refused",this.state.answereds[c.id]&&--this.state.points)}}console.log("Client id is: "+this.state.id);console.log("Questions: "+JSON.stringify(this.state.questions));this.state.act=function(a){return function(){h.send(JSON.stringify(a))}};this.forceUpdate()}.bind(this);setInterval(function(){this.forceUpdate()}.bind(this),500)},render:function(){function h(a){return div({className:"centralizer_outer"},div({className:"centralizer_inner"},
a))}var b=function(a){var c=div({className:"question_title"},[a.text]),d=div({className:"question_seconds"},Math.floor(((a.answer_time||Date.now())-a.time)/1E3)+'"'),b=div({className:"question_persons"},a.persons+"\uc6c3"),d=div({className:"question_head_box"},[d,b]),b=div({onClick:function(){this.state.act({type:"accept",user_id:this.state.id,question_id:a.id})()}.bind(this),className:"question_acception "+("accepted"===a.status?"accepted":"")},"\u2713"),e=div({onClick:function(){this.state.act({type:"refuse",
user_id:this.state.id,question_id:a.id})()}.bind(this),className:"question_acception "+("refused"===a.status?"refused":"")},"\u2717"),b=div({className:"question_acception_box"},[b,e]),d=div({className:"question_head"},[d,b]),b=div({className:"question_answer"},[""!==a.answer?a.answer:"Esperando resposta..."]),c=div({className:"question_body"},[c,b]),b=div({className:"question_lamp"},img({src:"routing"===a.status?""===a.answer?"img/lampada_apagada.png":"img/lampada_acesa.gif":"accepted"===a.status?
"img/lampada_acesa.png":"img/lampada_apagada.png",alt:"lampada",width:"100",height:"100"}));return div({className:"question"},[d,c,b])}.bind(this),a=this.state,d=div({onClick:function(){a.page="home"}.bind(this),className:"home"===a.page?"logo":"logo_small"},"dunno"),k=div({className:"question_field_box"},input({id:"question_field",key:"question_field",className:"question_field",placeholder:"<inserir slogan aqui>",onKeyPress:function(a){13===a.which&&e()},onChange:function(b){a.question=b.target.value;
this.forceUpdate()}.bind(this),type:"text"})),e=function(){0!==a.question.length&&(this.state.act({type:"ask",question:a.question,time:Date.now(),user_id:a.id})(),a.question="",a.page="wall",this.forceUpdate(),document.getElementById("question_field").value="")}.bind(this),c=div({id:"ask_button",key:"ask_button",onClick:e,className:"button ask_button"},["Fazer pergunta"]),f=div({id:"quick_button",key:"quick_button",onClick:function(){a.page="answering";this.forceUpdate()}.bind(this),className:"button quick_button"},
["Prefiro responder"]),f=div({key:"buttons_container",className:"button_container"},[c,f]),f=div({className:"home"},[d,k,f]),k=div({className:"wall_top"},h(div({className:"wall_top_content"},[d,k,c]))),c=a.questions.filter(function(b){return b.user_id===a.id}.bind(this)).reverse(),c=h(c.map(b)),k=div({className:"wall"},[k,c]),c=div({className:"answering_points"},"("+this.state.points+" ponto"+(1===this.state.points?"":"s")+"!)"),d=div({className:"answering_top"},[d,c]),g=function(){for(var b=null,
d=0,c=1103515245*a.id+12345&2147483647,e=0,f=a.questions.length;e<f;++e)c=1103515245*c+12345&2147483647,c>d&&a.questions[e]&&""===a.questions[e].answer&&!a.dunnos[e]&&(b=a.questions[e],d=c);return b}(),b=g?b(g):[],l=function(){var b=document.getElementById("answering_input");this.state.act({type:"answer",time:Date.now(),user_id:a.id,question_id:g.id,answer:b.value})();b.value=""}.bind(this),m=function(){this.state.act({type:"dunno",user_id:a.id,question_id:g.id})()}.bind(this),c=div({className:"answering_button",
onClick:l},"Responder"),m=div({className:"answering_button",onClick:m},"Pular"),c=div({className:"answer_menu"},[div({},input({id:"answering_input",className:"answering_input ",onKeyDown:function(a){13===a.which&&l()}})),div({},[c,m])]),b=div({className:"answering_body"},[b,c]),c=div({className:"answering_done"},["Nada para responder! Esperando novas quest\u00f5es."]),b=g?div({},[d,h(b)]):div({},[d,h(c)]);return"home"===a.page?f:"wall"===a.page?k:b}});window.onload=function(){ReactDOM.render(React.createElement(g,
null),document.getElementById("test"))}}).call(this,"undefined"!==typeof global?global:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{})},{}]},{},[1]);
