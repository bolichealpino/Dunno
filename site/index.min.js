(function e$$0(g,h,m){function l(c,a){if(!h[c]){if(!g[c]){var b="function"==typeof require&&require;if(!a&&b)return b(c,!0);if(n)return n(c,!0);b=Error("Cannot find module '"+c+"'");throw b.code="MODULE_NOT_FOUND",b;}b=h[c]={exports:{}};g[c][0].call(b.exports,function(a){var b=g[c][1][a];return l(b?b:a)},b,b.exports,e$$0,g,h,m)}return h[c].exports}for(var n="function"==typeof require&&require,k=0;k<m.length;k++)l(m[k]);return l})({1:[function(p,g,h){(function(g){for(var l in React.DOM)g[l]=React.DOM[l];
var h=React.createClass({getInitialState:function(){return{id:0,ws:null,page:"home",question:"",questions:[],answereds:[],dunnos:[],points:0}},componentDidMount:function(){var k=new WebSocket(SERVER_URL);k.onopen=function(){console.log("connected")};k.onmessage=function(c){c=JSON.parse("["+c.data+"]");var a=!1;if(0===this.state.id){a=!0;++this.state.id;for(var b=0,f=c.length;b<f;++b)"join"===c[b].type&&++this.state.id}b=0;for(f=c.length;b<f;++b){var e=c[b],d=this.state.questions[e.question_id];switch(e.type){case "ask":this.state.questions.push({id:this.state.questions.length,
user_id:e.user_id,text:e.question,time:a?e.time:Date.now(),answer:"",answer_time:0,persons:0,status:"routing"});break;case "answer":d.answer=e.answer;d.answer_time=a?e.time:Date.now();e.user_id===this.state.id&&(this.state.answereds[e.question_id]=!0);break;case "dunno":++d.persons;e.user_id===this.state.id&&(this.state.dunnos[e.question_id]=!0);break;case "accept":""!==d.answer&&"routing"===d.status&&e.user_id===d.user_id&&(d.status="accepted",this.state.answereds[d.id]&&++this.state.points);break;
case "refuse":""!==d.answer&&"routing"===d.status&&e.user_id===d.user_id&&(d.status="refused",this.state.answereds[d.id]&&--this.state.points)}}console.log("Client id is: "+this.state.id);console.log("Questions: "+JSON.stringify(this.state.questions));this.state.act=function(a){return function(){k.send(JSON.stringify(a))}};this.forceUpdate()}.bind(this);setInterval(function(){this.forceUpdate()}.bind(this),500)},render:function(){function k(a){return div({className:"centralizer_outer"},div({className:"centralizer_inner"},
a))}var c=function(a){var b=div({className:"question_title"},[a.text]),d=div({className:"question_seconds"},Math.floor(((a.answer_time||Date.now())-a.time)/1E3)+'"'),c=div({className:"question_persons"},a.persons+"\uc6c3"),d=div({className:"question_head_box"},[d,c]),c=div({onClick:function(){this.state.act({type:"accept",user_id:this.state.id,question_id:a.id})()}.bind(this),className:"question_acception "+("accepted"===a.status?"accepted":"")},"\u2713"),e=div({onClick:function(){this.state.act({type:"refuse",
user_id:this.state.id,question_id:a.id})()}.bind(this),className:"question_acception "+("refused"===a.status?"refused":"")},"\u2717"),c=div({className:"question_acception_box"},[c,e]),d=div({className:"question_head"},[d,c]),c=div({className:"question_answer"},[""!==a.answer?a.answer:"Esperando resposta..."]),b=div({className:"question_body"},[b,c]),c=div({className:"question_lamp"},img({src:"routing"===a.status?""===a.answer?"img/lampada_apagada.png":"img/lampada_acesa.gif":"accepted"===a.status?
"img/lampada_acesa.png":"img/lampada_apagada.png",alt:"lampada",width:"100",height:"100"}));return div({className:"question"},[d,b,c])}.bind(this),a=this.state,b=div({onClick:function(){a.page="home"}.bind(this),className:"home"===a.page?"logo":"logo_small"},"dunno"),f=div({className:"question_field_box"},input({id:"question_field",key:"question_field",className:"question_field",placeholder:"<inserir slogan aqui>",onKeyPress:function(a){13===a.which&&e()},onChange:function(b){a.question=b.target.value;
this.forceUpdate()}.bind(this),type:"text"})),e=function(){0!==a.question.length&&(this.state.act({type:"ask",question:a.question,time:Date.now(),user_id:a.id})(),a.question="",a.page="wall",this.forceUpdate(),document.getElementById("question_field").value="")}.bind(this),d=div({id:"ask_button",key:"ask_button",onClick:e,className:"button ask_button"},["Fazer pergunta"]),g=div({id:"quick_button",key:"quick_button",onClick:function(){a.page="answering";this.forceUpdate()}.bind(this),className:"button quick_button"},
["Prefiro responder"]),g=div({key:"buttons_container",className:"button_container"},[d,g]),g=div({className:"home"},[b,f,g]),f=div({className:"wall_top"},k(div({className:"wall_top_content"},[b,f,d]))),d=a.questions.filter(function(b){return b.user_id===a.id}.bind(this)).reverse(),c=k(d.map(c)),c=div({className:"wall"},[f,c]),f=div({className:"answering_points"},"("+this.state.points+" ponto"+(1===this.state.points?"":"s")+"!)"),b=div({className:"answering_top"},[b,f]),h=function(){for(var b=null,
c=0,d=1103515245*a.id+12345&2147483647,e=0,f=a.questions.length;e<f;++e)d=1103515245*d+12345&2147483647,d>c&&a.questions[e]&&""===a.questions[e].answer&&!a.dunnos[e]&&(b=a.questions[e],c=d);return b}(),f=h?div({className:"answering_question_title"},h.text):div([],[]),l=function(){var b=document.getElementById("answering_input");this.state.act({type:"answer",time:Date.now(),user_id:a.id,question_id:h.id,answer:b.value})();b.value=""}.bind(this),m=function(){this.state.act({type:"dunno",user_id:a.id,
question_id:h.id})()}.bind(this),d=div({className:"answering_button",onClick:l},"Responder"),m=div({className:"answering_button",onClick:m},"Pular"),d=div({className:"answer_menu"},[div({},input({id:"answering_input",className:"answering_input ",onKeyDown:function(a){13===a.which&&l()}})),div({},[d,m])]),f=div({className:"answering_body"},[f,d]),d=div({className:"answering_done"},["Nada para responder! Esperando novas quest\u00f5es."]),b=h?div({},[b,k(f)]):div({},[b,k(d)]);return"home"===a.page?g:
"wall"===a.page?c:b}});window.onload=function(){ReactDOM.render(React.createElement(h,null),document.getElementById("test"))}}).call(this,"undefined"!==typeof global?global:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{})},{}]},{},[1]);
