(function e$$0(h,g,m){function l(d,a){if(!g[d]){if(!h[d]){var b="function"==typeof require&&require;if(!a&&b)return b(d,!0);if(n)return n(d,!0);b=Error("Cannot find module '"+d+"'");throw b.code="MODULE_NOT_FOUND",b;}b=g[d]={exports:{}};h[d][0].call(b.exports,function(a){var b=h[d][1][a];return l(b?b:a)},b,b.exports,e$$0,h,g,m)}return g[d].exports}for(var n="function"==typeof require&&require,k=0;k<m.length;k++)l(m[k]);return l})({1:[function(p,h,g){(function(h){for(var l in React.DOM)h[l]=React.DOM[l];
var g=React.createClass({getInitialState:function(){return{id:0,ws:null,page:"home",question:"",questions:[],answereds:[],dunnos:[],points:0}},componentDidMount:function(){var k=new WebSocket(SERVER_URL);k.onopen=function(){console.log("connected")};k.onmessage=function(d){d=JSON.parse("["+d.data+"]");var a=!1;if(0===this.state.id){a=!0;++this.state.id;for(var b=0,e=d.length;b<e;++b)"join"===d[b].type&&++this.state.id}b=0;for(e=d.length;b<e;++b){var f=d[b],c=this.state.questions[f.question_id];switch(f.type){case "ask":this.state.questions.push({id:this.state.questions.length,
user_id:f.user_id,text:f.question,time:a?f.time:Date.now(),answer:"",answer_time:0,persons:0,status:"routing"});break;case "answer":c.answer=f.answer;c.answer_time=a?f.time:Date.now();f.user_id===this.state.id&&(this.state.answereds[f.question_id]=!0);break;case "dunno":++c.persons;f.user_id===this.state.id&&(this.state.dunnos[f.question_id]=!0);break;case "accept":""!==c.answer&&"routing"===c.status&&f.user_id===c.user_id&&(c.status="accepted",this.state.answereds[c.id]&&++this.state.points);break;
case "refuse":""!==c.answer&&"routing"===c.status&&f.user_id===c.user_id&&(c.status="refused",this.state.answereds[c.id]&&--this.state.points)}}console.log("Client id is: "+this.state.id);console.log("Questions: "+JSON.stringify(this.state.questions));this.state.act=function(a){return function(){k.send(JSON.stringify(a))}};this.forceUpdate()}.bind(this);setInterval(function(){this.forceUpdate()}.bind(this),500)},render:function(){function k(a){return div({className:"centralizer_outer"},div({className:"centralizer_inner"},
a))}var d=function(a){var b=div({className:"question_title"},[a.text]),c=div({className:"question_seconds"},Math.floor(((a.answer_time||Date.now())-a.time)/1E3)+'"'),d=div({className:"question_persons"},a.persons+"\uc6c3"),c=div({className:"question_head_box"},[c,d]),d=div({onClick:function(){this.state.act({type:"accept",user_id:this.state.id,question_id:a.id})()}.bind(this),className:"question_acception "+("accepted"===a.status?"accepted":"")},"\u2713"),e=div({onClick:function(){this.state.act({type:"refuse",
user_id:this.state.id,question_id:a.id})()}.bind(this),className:"question_acception "+("refused"===a.status?"refused":"")},"\u2717"),d=div({className:"question_acception_box"},[d,e]),c=div({className:"question_head"},[c,d]),d=div({className:"question_answer"},[""!==a.answer?a.answer:"Esperando resposta..."]),b=div({className:"question_body"},[b,d]),d=div({className:"question_lamp"},img({src:"routing"===a.status?""===a.answer?"img/lampada_apagada.png":"img/lampada_acesa.gif":"accepted"===a.status?
"img/lampada_acesa.png":"img/lampada_apagada.png",alt:"lampada",width:"100",height:"100"}));return div({className:"question"},[c,b,d])}.bind(this),a=this.state,b=div({onClick:function(){a.page="home"}.bind(this),className:"home"===a.page?"logo":"logo_small"},"dunno"),e=div({className:"question_field_box"},input({id:"question_field",key:"question_field",className:"question_field",placeholder:"<inserir slogan aqui>",onKeyPress:function(a){13===a.which&&f()},onChange:function(b){a.question=b.target.value;
this.forceUpdate()}.bind(this),type:"text"})),f=function(){0!==a.question.length&&(this.state.act({type:"ask",question:a.question,time:Date.now(),user_id:a.id})(),a.question="",a.page="wall",this.forceUpdate(),document.getElementById("question_field").value="")}.bind(this),c=div({id:"ask_button",key:"ask_button",onClick:f,className:"button ask_button"},["Fazer pergunta"]),h=div({id:"quick_button",key:"quick_button",onClick:function(){a.page="answering";this.forceUpdate()}.bind(this),className:"button quick_button"},
["Prefiro responder"]),h=div({key:"buttons_container",className:"button_container"},[c,h]),h=div({className:"home"},[b,e,h]),e=div({className:"wall_top"},k(div({className:"wall_top_content"},[b,e,c]))),c=a.questions.filter(function(b){return b.user_id===a.id}.bind(this)).reverse(),d=k(c.map(d)),d=div({className:"wall"},[e,d]),e=div({className:"answering_points"},"("+this.state.points+" ponto"+(1===Math.abs(this.state.points)?"":"s")+"!)"),b=div({className:"answering_top"},[b,e]),g=function(){for(var b=
null,d=0,c=1103515245*a.id+12345&2147483647,e=0,f=a.questions.length;e<f;++e)c=1103515245*c+12345&2147483647,c>d&&a.questions[e]&&""===a.questions[e].answer&&!a.dunnos[e]&&(b=a.questions[e],d=c);return b}(),e=div({className:"answering_question_clock"},img({src:"img/cronometro.gif",className:"answering_question_clock_icon"})),c=div({className:"answering_question_text"},g?g.text:""),e=g?div({className:"answering_question"},[e,c]):div([],[]),l=function(){var b=document.getElementById("answering_input");
this.state.act({type:"answer",time:Date.now(),user_id:a.id,question_id:g.id,answer:b.value})();b.value=""}.bind(this),m=function(){this.state.act({type:"dunno",user_id:a.id,question_id:g.id})()}.bind(this),c=div({className:"answering_button",onClick:l},"Responder"),m=div({className:"answering_button",onClick:m},"Pular"),c=div({className:"answer_menu"},[div({},input({id:"answering_input",className:"answering_input ",onKeyDown:function(a){13===a.which&&l()}})),div({},[c,m])]),e=div({className:"answering_body"},
[e,c]),c=div({className:"answering_done"},["Nada para responder! Esperando novas quest\u00f5es."]),b=g?div({},[b,k(e)]):div({},[b,k(c)]);return"home"===a.page?h:"wall"===a.page?d:b}});window.onload=function(){ReactDOM.render(React.createElement(g,null),document.getElementById("test"))}}).call(this,"undefined"!==typeof global?global:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{})},{}]},{},[1]);
